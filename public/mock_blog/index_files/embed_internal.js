Msn=window.Msn||{};Msn.Video=window.Msn.Video||new function(){};Msn.Video.Widgets={playerarticle:{current:{path:"fl/player/current/player.swf"}},player:{"2":{path:"flash/soapbox1_1.swf",oldRoot:true},current:{path:"fl/player/current/player.swf"}},playerrtl:{current:{path:"flash/soapbox1_1RTL.swf",oldRoot:true}},playerad:{"2":{path:"flash/soapbox1_1.swf",oldRoot:true},current:{path:"fl/player/current/player.swf"}},slplayer:{current:{path:"sl/player/current/player.xap"},silverlight:true},slplayerad:{current:{path:"sl/player/current/player.xap"},silverlight:true},gallery:{"2":{path:"flash/gallerywidget/1_0/gallerywidget.swf",oldRoot:true},current:{path:"fl/gallerywidget/current/gallerywidget.swf"}},galleryrtl:{current:{path:"flash/gallerywidget/1_0/gallerywidget.swf",oldRoot:true}},customplayer:{"2":{path:"flash/customplayer/1_0/customplayer.swf",oldRoot:true},current:{path:"fl/customplayer/current/customPlayer.swf"}}};Msn.Video.initializeVersionTable=function(){var e=Msn.Video.JavascriptApi.getQSPs();if(checkString(e.versiontable)){var d=e.versiontable.split(";");for(var g in d){var b=d[g].split(":");if(b.length==2)Msn.Video.VersionTable[b[0]]=b[1]}}var a={};for(var c in Msn.Video.VersionTable)if(checkString(Msn.Video.VersionTable[c])){var f=c.toLowerCase();a[f]=Msn.Video.VersionTable[c];if("global"!=f)a.hasVersions=true}Msn.Video.VersionTable=a};Msn.Video.isSafari=function(){return /Version\/(\d+\.\d+)(.\d+)*\sSafari/.test(navigator.userAgent)};Msn.Video.safariVersion=function(){var a=0;if(/Version\/(\d+\.\d+)(.\d+)*\sSafari/.test(navigator.userAgent))a=new Number(RegExp.$1);return a};function isFirefox(){return navigator.userAgent.toLowerCase().indexOf("firefox")>=0}Msn.Video.firefoxVersion=function(){var a=0;if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))a=new Number(RegExp.$1);return a};function isChrome(){return navigator.userAgent.toLowerCase().indexOf("chrome")>=0}Msn.Video.chromeVersion=function(){var a=0;if(/Chrome[\/\s](\d+\.\d+)/.test(navigator.userAgent))a=new Number(RegExp.$1);return a};Msn.Video.isIE=function(a){return navigator.userAgent.indexOf("MSIE "+(a?a+".":""))>0};function IEVersion(){var b=/MSIE \d+\.?/,a=0;if(/MSIE (\d+\.\d+);/.test(navigator.userAgent))a=new Number(RegExp.$1);return a}function checkDefined(a){return typeof a!="undefined"&&null!=a}function checkString(a){return typeof a=="string"&&a.length>0}function checkObject(a){return typeof a=="object"&&null!=a}function checkArray(c,b){var a=c instanceof Array;if(b!="")a=a&&c.length>=b;return a}function checkFunction(a){return typeof a=="function"}function checkInt(a,c,b){if(null!=a&&(typeof a!="string"||""!=a)&&!isNaN(a)){if(checkDefined(c)&&a<c)return false;if(checkDefined(b)&&a>b)return false;return true}return false}function parseBool(a){return typeof a!="undefined"&&null!=a&&a.toLowerCase()=="true"}function padLeft(d,c,b){var a="";while(a.length<c)a=a+b;return a+d}function format(b){for(var a=1;a<arguments.length;a++)b=b.split("{"+(a-1)+"}").join(arguments[a]);return b}function openStandardWindow(b,a){return openWindow(b,a,1024,768,"resizable=yes,toolbar=yes,menubar=yes,scrollbars=yes,status=yes,location=yes")}function openWindow(c,b,e,d,a){window.open(c,b,format("width={0},height={1}{2}",e,d,a?","+a:""))}Msn.Video.EVENT_FLASH_DETECT="flash_detect";Msn.Video.FlashObject=function(u,v,r,q,s){var g="menu",f="base",h="bgColor",e="wmode",c=null,d=this,t=d,y=[],x=[],a=c,i=c,w=false,j=u,p=v,b=s,k=false,m=0,n=0,l=0,o;b=b||{};if(b[e]==undefined)b[e]="transparent";if(b[h]==undefined)b[h]="#000000";if(b[f]==undefined)b[f]=".";if(b[g]==undefined)b[g]="false";Msn.Video.FlashVersionDetectInstance.addListener(d);d.onEvent=function(c,a){switch(a){case Msn.Video.EVENT_FLASH_DETECT:if(!Msn.Video.FlashVersionDetectInstance.checkVersion(m,n,l))this.onVersionDetectionFailure()}};d.getObjectNode=function(){return a};d.setInstallCtrl=function(d,b,c,a){if(d!=undefined)i=d;m=b!=undefined?b:0;n=c!=undefined?c:0;l=a!=undefined?a:0};d.onDispose=function(){if(Msn.Video.isIE())try{for(var b in a)if(checkFunction(a[b]))a[b]=empty}catch(d){}a=c};d.onVersionDetectionFailure=function(){k=true;this.render(o)};d.verifyIEInstall=function(){var a=document.getElementById(j);if(a.allowScriptAccess==undefined)t.onVersionDetectionFailure()};d.render=function(s){var t="flashvars",d='">';o=s;o.innerHTML="";if(c!=s&&checkString(p)){if(Msn.Video.FlashVersionDetectInstance&&!Msn.Video.FlashVersionDetectInstance.checkVersion(m,n,l))k=true;if(k&&i)i.render(s);else if(Msn.Video.isIE()){s.innerHTML='<object id="'+j+'" '+'name="'+j+'" '+'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" '+'height="'+q+'" '+'width="'+r+'"> '+'<param name="movie" value="'+p+d+'<param name="flashvars" value="'+b[t]+'"/> '+'<param name="menu" value="'+b[g]+d+'<param name="wmode" value="'+b[e]+d+'<param name="play" value="0">'+'<param name="quality" value="high">'+'<param name="allowScriptAccess" value="always">'+'<param name="allowFullScreen" value="true">'+'<param name="bgcolor" value="'+b[h]+d+'<param name="base" value="'+b[f]+d+"</object>";a=s.childNodes[0];if(i)setTimeout(this.verifyIEInstall,1e3)}else{a=document.createElement("EMBED");a.id=j;a.setAttribute("name",j);a.setAttribute("bgcolor",b[h]);a.setAttribute("allowScriptAccess","always");a.setAttribute(g,b[g]);a.setAttribute("quality","high");a.setAttribute("type","application/x-shockwave-flash");a.setAttribute("src",p);a.setAttribute("width",r);a.setAttribute("height",q);a.setAttribute("flashVars",b[t]);a.setAttribute(e,b[e]);a.setAttribute(f,b[f]);a.setAttribute("allowFullScreen","true");s.appendChild(a);if(i&&!(navigator.plugins!=c&&navigator.plugins.length>0&&(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"])))this.onVersionDetectionFailure()}}else a=c}};Msn.Video.FlashVersionDetect=function(h){var a=this,f=a,c,d,e,b=[],g=h;if(!checkDefined(Msn.Video.FlashVersionDetectInstance))Msn.Video.FlashVersionDetectInstance=a;a.addListener=function(a){b.push(a)};a.fireEvent=function(e,c,d){for(var a=0;a<b.length;a++)if(checkDefined(b[a])&&checkFunction(b[a].onEvent))b[a].onEvent(this,e,c,d)};a.render=function(b){if(null!=b){b.style.position="absolute";var i="versiondetect",j=format("{0}/{1}flash/versionDetect.swf",Msn.Video.UrlHelper.getWERoot(g),Msn.Video.getVersionedWidgetsPath()),h=new Msn.Video.FlashObject(i,j,1,1);h.render(b);var a=h.getObjectNode();if(a){if(a.attachEvent)a.attachEvent("fscommand",f.onVersion);window[i+"_DoFSCommand"]=f.onVersion}else c=d=e=0}};a.checkVersion=function(a,b,f){if(c>a||c==undefined)return true;else if(c==a)if(d>b||d==undefined)return true;else if(d==b&&(e>=f||e==undefined))return true;return false};a.onVersion=function(b){try{var a=b.split(" ")[1];a=a.split(",");c=checkInt(a[0])?a[0]:0;d=checkInt(a[1])?a[1]:0;e=checkInt(a[2])?a[2]:0;f.fireEvent(Msn.Video.EVENT_FLASH_DETECT,b)}catch(g){}}};Msn.Video.FlashInstall=function(e){var b="_blank",c=this,a=c,d=e;c.cfg={REQUIRE_FLASH:"Please install the latest version of the free Adobe Flash Player. ",REQUIRE_FLASH_LINK:"Download now.",HELP_FLASH:"For help with Flash, see Adobe's ",HELP_FLASH_LINK:"Flash Player Support page.",FLASH_INSTALL_URL:"http://g.msn.com/0VD0/34/67?CM=not_auto_flash",FLASH_HELP_URL:"http://www.adobe.com/cfusion/knowledgebase/index.cfm?id=tn_15511"};c.onFlashInstall=function(){setTimeout(a.onFlashInstallComplete,1e3)};c.onFlashInstallComplete=function(){openStandardWindow(a.cfg.FLASH_INSTALL_URL,b)};c.render=function(h){if(null!=h)if(checkDefined(d))h.appendChild(d);else{var g=document.createElement("DIV");g.className="flashInstallParent";h.appendChild(g);var c=document.createElement("DIV");c.className="flashInstall";c.style.backgroundColor="#e0e0e0";c.style.color="#666";c.style.fontFamily="Tahoma";c.style.fontSize="8pt";c.style.fontWeight="bold";c.style.padding="30px";g.appendChild(c);var f=document.createElement("span");f.innerHTML=a.cfg.REQUIRE_FLASH;c.appendChild(f);var e=document.createElement("a");e.setAttribute("href",a.cfg.FLASH_INSTALL_URL);e.setAttribute("target",b);e.innerHTML=a.cfg.REQUIRE_FLASH_LINK;e.style.color="#07519a";c.appendChild(e);c.appendChild(document.createElement("BR"));c.appendChild(document.createElement("BR"));f=document.createElement("span");f.innerHTML=a.cfg.HELP_FLASH;c.appendChild(f);e=document.createElement("a");e.setAttribute("href",a.cfg.FLASH_HELP_URL);e.setAttribute("target",b);e.innerHTML=a.cfg.HELP_FLASH_LINK;e.style.color="#07519a";c.appendChild(e)}}};if(!window.Silverlight)window.Silverlight={};Silverlight._silverlightCount=0;Silverlight.__onSilverlightInstalledCalled=false;Silverlight.fwlinkRoot="http://go2.microsoft.com/fwlink/?LinkID=";Silverlight.__installationEventFired=false;Silverlight.onGetSilverlight=null;Silverlight.onSilverlightInstalled=function(){window.location.reload(false)};Silverlight.isInstalled=function(d){var b=true,c=null;if(d==undefined)d=c;var a=false,o=c;try{var k=c,l=false;if(window.ActiveXObject)try{k=new ActiveXObject("AgControl.AgControl");if(d===c)a=b;else if(k.IsVersionSupported(d))a=b;k=c}catch(n){l=b}else l=b;if(l){var m=navigator.plugins["Silverlight Plug-In"];if(m)if(d===c)a=b;else{var j=m.description;if(j==="1.0.30226.2")j="2.0.30226.2";var e=j.split(".");while(e.length>3)e.pop();while(e.length<4)e.push(0);var g=d.split(".");while(g.length>4)g.pop();var f,i,h=0;do{f=parseInt(g[h]);i=parseInt(e[h]);h++}while(h<g.length&&f===i);if(f<=i&&!isNaN(f))a=b}}}catch(n){a=false}return a};Silverlight.WaitForInstallCompletion=function(){if(!Silverlight.isBrowserRestartRequired&&Silverlight.onSilverlightInstalled){try{navigator.plugins.refresh()}catch(a){}if(Silverlight.isInstalled(null)&&!Silverlight.__onSilverlightInstalledCalled){Silverlight.onSilverlightInstalled();Silverlight.__onSilverlightInstalledCalled=true}else setTimeout(Silverlight.WaitForInstallCompletion,3e3)}};Silverlight.__startup=function(){navigator.plugins.refresh();Silverlight.isBrowserRestartRequired=Silverlight.isInstalled(null);if(!Silverlight.isBrowserRestartRequired){Silverlight.WaitForInstallCompletion();if(!Silverlight.__installationEventFired){Silverlight.onInstallRequired();Silverlight.__installationEventFired=true}}else if(window.navigator.mimeTypes){var b=navigator.mimeTypes["application/x-silverlight-2"],c=navigator.mimeTypes["application/x-silverlight-2-b2"],d=navigator.mimeTypes["application/x-silverlight-2-b1"],a=d;if(c)a=c;if(!b&&(d||c)){if(!Silverlight.__installationEventFired){Silverlight.onUpgradeRequired();Silverlight.__installationEventFired=true}}else if(b&&a)if(b.enabledPlugin&&a.enabledPlugin)if(b.enabledPlugin.description!=a.enabledPlugin.description)if(!Silverlight.__installationEventFired){Silverlight.onRestartRequired();Silverlight.__installationEventFired=true}}if(!Silverlight.disableAutoStartup)if(window.removeEventListener)window.removeEventListener("load",Silverlight.__startup,false);else window.detachEvent("onload",Silverlight.__startup)};if(!Silverlight.disableAutoStartup)if(window.addEventListener)window.addEventListener("load",Silverlight.__startup,false);else window.attachEvent("onload",Silverlight.__startup);Silverlight.createObject=function(n,f,e,l,m,h,k){var d={},a=l,c=m;d.version=a.version;a.source=n;d.alt=a.alt;if(h)a.initParams=h;if(a.isWindowless&&!a.windowless)a.windowless=a.isWindowless;if(a.framerate&&!a.maxFramerate)a.maxFramerate=a.framerate;if(e&&!a.id)a.id=e;delete a.ignoreBrowserVer;delete a.inplaceInstallPrompt;delete a.version;delete a.isWindowless;delete a.framerate;delete a.data;delete a.src;delete a.alt;if(Silverlight.isInstalled(d.version)){for(var b in c)if(c[b]){if(b=="onLoad"&&typeof c[b]=="function"&&c[b].length!=1){var i=c[b];c[b]=function(a){return i(document.getElementById(e),k,a)}}var g=Silverlight.__getHandlerName(c[b]);if(g!=null){a[b]=g;c[b]=null}else throw"typeof events."+b+" must be 'function' or 'string'"}slPluginHTML=Silverlight.buildHTML(a)}else if(Silverlight.isInstalled("3.0")||Silverlight.isInstalled("2.0")||Silverlight.isInstalled("1.0")){slPluginHTML=Silverlight.buildPromptHTML(d);var j=confirm("This page requires a more recent version of Silverlight. Would you like to install the latest version of Silverlight?");if(j)Silverlight.getSilverlight()}else slPluginHTML=Silverlight.buildPromptHTML(d);if(f)f.innerHTML=slPluginHTML;else return slPluginHTML};Silverlight.buildHTML=function(a){var b=[];b.push('<object type="application/x-silverlight" data="data:application/x-silverlight,"');if(a.id!=null)b.push(' id="'+Silverlight.HtmlAttributeEncode(a.id)+'"');if(a.width!=null)b.push(' width="'+a.width+'"');if(a.height!=null)b.push(' height="'+a.height+'"');b.push(" >");delete a.id;delete a.width;delete a.height;for(var c in a)if(a[c])b.push('<param name="'+Silverlight.HtmlAttributeEncode(c)+'" value="'+Silverlight.HtmlAttributeEncode(a[c])+'" />');b.push("</object>");return b.join("")};Silverlight.createObjectEx=function(b){var a=b,c=Silverlight.createObject(a.source,a.parentElement,a.id,a.properties,a.events,a.initParams,a.context);if(a.parentElement==null)return c};Silverlight.buildPromptHTML=function(b){var a="",d=Silverlight.fwlinkRoot,c=b.version;if(b.alt)a=b.alt;else{if(!c)c="";a="<a href='javascript:Silverlight.getSilverlight(\"{1}\");' style='text-decoration: none;'><img src='{2}' alt='Get Microsoft Silverlight' style='border-style: none'/></a>";a=a.replace("{1}",c);a=a.replace("{2}",d+"108181")}return a};Silverlight.getSilverlight=function(e){if(Silverlight.onGetSilverlight)Silverlight.onGetSilverlight();var b="",a=String(e).split(".");if(a.length>1){var c=parseInt(a[0]);if(isNaN(c)||c<2)b="1.0";else b=a[0]+"."+a[1]}var d="";if(b.match(/^\d+\056\d+$/))d="&v="+b;Silverlight.followFWLink("114576"+d)};Silverlight.followFWLink=function(a){top.location=Silverlight.fwlinkRoot+String(a)};Silverlight.HtmlAttributeEncode=function(c){var a,b="";if(c==null)return null;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);if(a>96&&a<123||a>64&&a<91||a>43&&a<58&&a!=47||a==95)b=b+String.fromCharCode(a);else b=b+"&#"+a+";"}return b};Silverlight.default_error_handler=function(g,b){var e="Position: ",c="     \n",f,d=b.ErrorType;f=b.ErrorCode;var a="\nSilverlight error message     \n";a+="ErrorCode: "+f+"\n";a+="ErrorType: "+d+"       \n";a+="Message: "+b.ErrorMessage+c;if(d=="ParserError"){a+="XamlFile: "+b.xamlFile+c;a+="Line: "+b.lineNumber+c;a+=e+b.charPosition+c}else if(d=="RuntimeError"){if(b.lineNumber!=0){a+="Line: "+b.lineNumber+c;a+=e+b.charPosition+c}a+="MethodName: "+b.methodName+c}alert(a)};Silverlight.__cleanup=function(){for(var a=Silverlight._silverlightCount-1;a>=0;a--)window["__slEvent"+a]=null;Silverlight._silverlightCount=0;if(window.removeEventListener)window.removeEventListener("unload",Silverlight.__cleanup,false);else window.detachEvent("onunload",Silverlight.__cleanup)};Silverlight.__getHandlerName=function(b){var c="onunload",a="";if(typeof b=="string")a=b;else if(typeof b=="function"){if(Silverlight._silverlightCount==0)if(window.addEventListener)window.addEventListener(c,Silverlight.__cleanup,false);else window.attachEvent(c,Silverlight.__cleanup);var d=Silverlight._silverlightCount++;a="__slEvent"+d;window[a]=b}else a=null;return a};Silverlight.onRequiredVersionAvailable=function(){};Silverlight.onRestartRequired=function(){};Silverlight.onUpgradeRequired=function(){};Silverlight.onInstallRequired=function(){};Silverlight.IsVersionAvailableOnError=function(e,a){var b=true,c=false;try{if(a.ErrorCode==8001&&!Silverlight.__installationEventFired){Silverlight.onUpgradeRequired();Silverlight.__installationEventFired=b}else if(a.ErrorCode==8002&&!Silverlight.__installationEventFired){Silverlight.onRestartRequired();Silverlight.__installationEventFired=b}else if(a.ErrorCode==5014||a.ErrorCode==2106){if(Silverlight.__verifySilverlight2UpgradeSuccess(a.getHost()))c=b}else c=b}catch(d){}return c};Silverlight.IsVersionAvailableOnLoad=function(b){var a=false;try{if(Silverlight.__verifySilverlight2UpgradeSuccess(b.getHost()))a=true}catch(c){}return a};Silverlight.__verifySilverlight2UpgradeSuccess=function(d){var c=false,b="2.0.31005",a=null;try{if(d.IsVersionSupported(b+".99")){a=Silverlight.onRequiredVersionAvailable;c=true}else if(d.IsVersionSupported(b+".0"))a=Silverlight.onRestartRequired;else a=Silverlight.onUpgradeRequired;if(a&&!Silverlight.__installationEventFired){a();Silverlight.__installationEventFired=true}}catch(e){}return c};Msn.VideoSL=window["Msn.VideoSL"]||{};Msn.VideoSL.Inline=function(a){var d=this,c=a+"_p",b=a+"_pobj";this.BuildPlayer=function(d,p,o,k,j,m){var h="windowless",g="background",e="true",i={ifs:e,playlistmin:"2"},a;for(a in d)i[a]=d[a];d=[];for(a in i)if(i[a])d.push(a+"="+i[a].replace(/,/g,"%2C"));d=d.join(",");var f={width:p||300,height:o||269,framerate:"30",version:"4.0.50401",enableHtmlAccess:e,enableGPUAcceleration:e};for(var l in j)f[l]=j[l];if(undefined==f[g])f[g]="black";if(undefined==f[h])f[h]="false";var n={source:k?k:"http://img.widgets.video.s-msn.com/fl/player/current/player.xap",parentElement:document.getElementById(c),id:b,properties:f,events:m,initParams:d,context:null};Silverlight.createObjectEx(n)}};Msn.Video.createWidget=function(f,h,j,i,b,c,e,d,g,a){Msn.Video.createWidget2({divId:f,src:h,w:j,h:i,flashvars:b,widgetId:c,params:e,version:d,root:g,downlevel:a})};Msn.Video.createWidget2=function(a){var e="playeroverlay";if(!checkObject(a))throw new Error("Argument Error: 'param' is missing or not an object");var b=document.getElementById(a.divId);if(!checkDefined(b))throw new Error("Argument Error: no 'divId' parameter specified");if(!checkDefined(a.src))throw new Error("Argument Error: no 'src' parameter specified");var c=a.src.toLowerCase();if(!checkDefined(Msn.Video.Widgets[c])&&c!=e)throw new Error("Argument Error: invalid 'src' parameter specified");var f=Msn.Video.getVersionedWidgetsPath(getInitParam(a.flashvars,"version","current"));if(checkString(f)){a.flashvars=a.flashvars||{};setIfNotSet(a.flashvars,"versionPath",f)}switch(c){case "player":case "playerad":case "slplayer":case "slplayerad":var j=new Msn.Video.Player;j.create(a,b);break;case "playerarticle":var g=new Msn.Video.ArticlePlayer;g.create(a,b);break;case e:var h=new Msn.Video.OverlayPlayer;h.create(a,b);break;case "gallery":var i=new Msn.Video.Gallery;i.create(a,b);break;case "v5_container":var k=new Msn.Video.V5Container;k.create(a,b);break;default:var d=document.createElement("div");d.setAttribute("id",a.divId+"_content");b.appendChild(d);a.params=a.params||{};a.src=Msn.Video.getWidgetEmbedAsset(a);if(Msn.Video.Widgets[c]&&Msn.Video.Widgets[c].silverlight==true)Msn.Video.buildSLWidget(c,b,d,a,a.flashvars);else return Msn.Video.buildFlashWidget(b,d,a,a.flashvars)}};Msn.Video.spawnOverlay=function(a){if(!a)throw new Error("missing param 'param'");if(!checkDefined(a.url))throw new Error("invalid param, missing param.url member");if(IEVersion()>=7||Msn.Video.firefoxVersion()>=3.5||Msn.Video.chromeVersion()>=9||Msn.Video.safariVersion()>=5)Msn.Video.OverlayProxy.create(a);else openStandardWindow(a.url,"_top");return false};Msn.Video.buildSLWidget=function(f,h,e,a,c){var b={};for(var d in c)b[d]=c[d].replace(/\,/g,"%2c");var g=new Msn.VideoSL.Inline(a.divId);if(f!="slplayerad")e.innerHTML="<div id='"+a.divId+"_p'></div>";g.BuildPlayer(b,a.w,a.h,a.src,a.params)};Msn.Video.buildFlashWidget=function(g,f,a,e){var d="";for(i in e)d+=i+"="+e[i].replace(/\&/g,"%26")+"&";a.params["flashvars"]=d;var h=new Msn.Video.FlashVersionDetect(a),c=new Msn.Video.FlashObject(a.widgetId||a.divId+"_flash",a.src,a.w,a.h,a.params);c.setInstallCtrl(new Msn.Video.FlashInstall(a.downlevel),9);var b=document.createElement("div");b.setAttribute("id",a.divId+"_detect");g.appendChild(b);h.render(b);c.render(f);return c.getObjectNode()};Msn.Video.getWidgetEmbedAsset=function(b){var c=b.src.toLowerCase(),h=Msn.Video.Widgets[c]&&Msn.Video.Widgets[c].silverlight==true,a=getInitParam(b.flashvars,"version",null);if(!a||!Msn.Video.Widgets[c][a])a="current";var g=Msn.Video.getVersionedWidgetsPath(a),f=Msn.Video.Widgets[c][a],d=f.oldRoot?getCreateWidgetParamValue(b,"root","images.video.msn.com"):Msn.Video.UrlHelper.getWERoot(b);d=normalizeRootUrl(d);var e=format("{0}/{1}{2}",d,g,f.path);if(b.cacheBuster)e+="?rand="+Math.random();return e};Msn.Video.getVersionedWidgetsPath=function(a){return !a||"current"==a?Msn.Video.CountryCodeLoader.getVersionPath():""};Msn.Video.buildPlayerAdElements=function(c,a){var d='<div class="video1"><h3 id="'+a+'_t"></h3><div id="'+a+'_p"></div><div id="'+a+'_m"></div><div id="'+a+'_a" class="playerAdDiv"></div><div id="'+a+'_r"></div></div>';c.innerHTML=d;var b=document.getElementById(a+"_p");return b};function getCreateWidgetParamValue(a,b,d){var c=d;if(a.hasOwnProperty(b)&&checkDefined(a[b]))c=a[b];return c}function normalizeRootUrl(a){if(a){if(a.indexOf("http://")!=0)a="http://"+a;if(a.lastIndexOf("/")==a.length-1)a=a.substring(0,a.length-1)}return a}function setParam(a,b,c){a[b.toLowerCase()]=c}function setIfNotSet(b,a,c){a=a.toLowerCase();if(!checkString(b[a]))b[a]=c}function getInitParam(b,c,d){var a=d||null;if(b&&checkString(c))a=b[c]||a;return a}function normalizeParamKeys(b){var a={};for(var c in b)a[c.toLowerCase()]=b[c];return a}function copyFlashVars(c,a){var e={};a=a.toLowerCase()+".";for(var d in c){var b=d.toLowerCase();if(b.indexOf(a)>=0||b.indexOf(".")<0)e[b.replace(a,"")]=c[d]}return e}Msn.Video.UrlHelper=new function(){var a=this;a.getWRoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"wRoot","widgets.video.msn.com"))};a.getWERoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"weRoot",Msn.Video.WidgetServer||"img.widgets.video.s-msn.com"))};a.getvceRoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"vceRoot","catalog.video.msn.com"))};a.getVCERoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"vceRoot","edge1.catalog.video.msn.com"))};a.getVCImgRoot=function(a){return normalizeRootUrl(getCreateWidgetParamValue(a,"vciRoot","img1.catalog.video.msn.com"))};function b(b,a){return b+(checkString(a)?"="+a:"")}a.addQueryToUri=function(c,d,f){var e=c;if(checkString(d)){var g=b(d,f),a=c.split("?");e=a[0]+"?"+(checkArray(a,2)&&checkString(a[1])?a[1]+"&":"")+g}return e};a.addParamValuesToQuery=function(d,b){var a=d;for(var c in b)a=this.addParamValueToQuery(a,c,b[c],false);return a};a.addParamValueToQuery=function(g,f,i,j){var c=g,h=false,e=c.split("?");if(checkArray(e,2)){c=e[0];var k=e[1],m=f.toLowerCase(),a=k.split("&");if(checkArray(a,1))for(var d=0;d<a.Length;d++)if(checkString(a[d])){var l=a[d].split("=")[0].toLowerCase();if(l==m){h=true;if(j){a[d]=b(f,i);c+="?"+a.join("&")}break}}}if(!h)c=this.addQueryToUri(g,f,i);return c}};Msn.Video.JavascriptApi=window.Msn.Video.JavascriptApi||function(){var d="head",g="scriptId",f="Invalid Argument: filename is missing or is not a string",c=false,a=null,k=this,h=0,b={};function j(d,c){if(checkObject(b[d])){c=c||b[d].callback;var f=b[d].context;e(d);if(checkFunction(c))c(a,f,new Error("timed out waiting for script to load"))}}function e(c){if(checkObject(b[c])){if(checkDefined(b[c].timeout))clearTimeout(b[c].timeout);b[c]=a;delete b[c]}}return {makeRequest:function(i,d,g,e){if(!d)d=a;if(!e)e=c;var f=h++;b[f]={context:d,callback:g};Msn.Video.JavascriptApi.fetchScript(i+"&callbackName=Msn.Video.JavascriptApi.onComplete&cd="+f,f,a,e)},loadJS:function(e,d,g){if(!checkString(e))throw new Error(f);if(!d)d=a;if(!g)g=c;var k=c,j=document.getElementsByTagName("script");for(var i=0;i<j.length;i++)if(j[i].src.toLowerCase().indexOf(e)>=0){k=true;break}if(!k){var l=h++;b[l]={};Msn.Video.JavascriptApi.fetchScript(e,l,d,g)}else if(checkFunction(d))d()},fetchScript:function(m,h,i,k){if(!i)i=a;if(!k)k=c;var f=document.createElement("script");f.setAttribute("type","text/javascript");f.setAttribute("src",m);f.setAttribute("id",g+h);if(checkFunction(i))if(f.readyState)f.onreadystatechange=function(){if("loaded"==f.readyState||"complete"==f.readyState){f.onreadystatechange=a;if(checkObject(b[h])){e(h);i()}}};else f.onload=function(){if(checkObject(b[h])){e(h);i()}};if(k)b[h].timeout=setTimeout(function(){j(h,i)},4e3);var l=document.getElementsByTagName(d)[0];l.appendChild(f)},onComplete:function(k,c,f){if(checkObject(b[c])){var j=b[c].context,i=b[c].callback;e(c);if(!checkDefined(f))f=a;i(k,j,f)}var h=document.getElementById(g+c);if(checkDefined(h))setTimeout(function(){var a=document.getElementsByTagName(d)[0];a.removeChild(h)},0)},loadCSS:function(b){if(!checkString(b))throw new Error(f);var d=c,a,h=document.getElementsByTagName("link");for(var e=0;e<h.length;e++){a=h[e].href;if(checkString(a)&&a.toLowerCase().indexOf(b)>=0){d=true;break}}var g=document.styleSheets;for(i=0;i<g.length;i++){a=g[i].href;if(checkString(a)&&a.toLowerCase().indexOf(b)>=0){d=true;break}}if(!d)Msn.Video.JavascriptApi.fetchCSS(b)},fetchCSS:function(c){var a=document.createElement("link");a.setAttribute("type","text/css");a.setAttribute("rel","stylesheet");a.setAttribute("href",c);var b=document.getElementsByTagName(d)[0];b.appendChild(a)},getCookie:function(b){var f=a;if(checkString(b)){b=b.toLowerCase();var e=document.cookie.split(";");for(var d=0;d<e.length;++d){var c=e[d].split("="),g=c[0].replace(/^\s+|\s+$/g,"").toLowerCase();if(g==b){if(c.length>1)f=c[1].replace(/^\s+|\s+$/g,"");break}}}return f},setCookie:function(e,d,b){var a=e.toLowerCase()+"="+d+";path=/";if(b!=0){var f=new Date,c=new Date(f.getTime()+b*1e3);a+=";expires="+c.toGMTString()}document.cookie=a+";domain="+document.domain;document.cookie=a+";domain=.video.msn.com"},getQSPs:function(b){b=b||(window.location&&"undefined"!=window.location.search?window.location.search.substring(1):"");var f={};if(checkString(b)){var e=b.split("&");for(var d=0;d<e.length;++d){param=e[d];if(param.length>0){var c=param.split("=");f[c[0].toLowerCase()]=c.length>1?unescape(c[1]).toLowerCase():a}}}return f}}}();Msn.Video.CountryCodeLoader=window.Msn.Video.CountryCodeLoader||function(){var c=null,d="CountryCode",b=Msn.Video.JavascriptApi.getCookie(d),a;return {getCountryCode:function(){return b},setCountryCode:function(a){b=(a||"").toLowerCase();var c=checkString(b)?7*24*60*60:-1;Msn.Video.JavascriptApi.setCookie(d,b,c)},loadCountryCode:function(a){if(!checkString(b)){var d="video.msn.com";if(checkString(Msn.Video.LocationServiceHost))d=Msn.Video.LocationServiceHost;var f="http://"+d+"/soapboxservice2.aspx?mn=GetCountryCode&responseEncoding=json";Msn.Video.JavascriptApi.makeRequest(f,c,function(b){e(b,a)},true)}else if(a)e(c,a)},getVersionPath:function(){if(!a){a="";if(Msn.Video.VersionTable){if(checkString(b)&&checkString(Msn.Video.VersionTable[b]))a=Msn.Video.VersionTable[b];else if(checkString(Msn.Video.VersionTable["global"]))a=Msn.Video.VersionTable["global"];if(0==a.indexOf("/"))a=a.slice(1);if(a.length-1!=a.lastIndexOf("/"))a+="/"}}return a}};function e(a,d){if(a&&checkObject(a.ReverseIPResult)&&checkObject(a.ReverseIPResult.StatusCode)&&checkString(a.ReverseIPResult.StatusCode.$)&&a.ReverseIPResult.StatusCode.$.toLowerCase()=="success"){var f=checkDefined(a.ReverseIPResult.CountryCode)?a.ReverseIPResult.CountryCode.$:c;if(checkString(f))Msn.Video.CountryCodeLoader.setCountryCode(f);var e=checkDefined(a.ReverseIPResult.Zip)?a.ReverseIPResult.Zip.$:c;if(checkString(e))Msn.Video.JavascriptApi.setCookie("ZipCode",e,7*24*60*60)}if(d&&"function"==typeof d)d(b)}}();Msn.Video.ResourceMgr=function(f,c){var e=this,b="default",a={};function d(a,f){if(checkDefined(f))b=f;if(a)for(var c=0;c<a.length;c++){var j=a[c].Key.toLowerCase(),h=a[c].Value;for(var d=0;d<h.length;d++){var g=h[d],i=g.Key.toLowerCase();e.setValue(j,i,g.Value)}}}this.getValue=function(b,c,e){var d=e;b=b.toLowerCase();c=c.toLowerCase();if(a.hasOwnProperty(b)&&a[b].hasOwnProperty(c))d=a[b][c];return d};this.setValue=function(d,e,g){if(null==d||d=="default")d=b;d=d.toLowerCase();e=e.toLowerCase();var f=e.indexOf(".");if(d==c&&f>0){d=e.substring(0,f);e=e.substr(f+1)}if(!a.hasOwnProperty(d))a[d]={};a[d][e]=g};d(f,c)};Msn.Video.loadConfiguration=function(a,f,h,i){var c="",d="",e="";if(checkDefined(a.flashvars)){var b=new Msn.Video.ConfigMgr(null,a.flashvars);c=b.getValue("mkt",c);d=b.getValue("configCsid","");e=b.getValue("configName","")}var j=Msn.Video.UrlHelper.getWERoot(a),g=j+"/resource.aspx?resources="+f+"&gmts="+h+"&mkt="+c+"&configCsid="+d+"&configName="+e+"&responseEncoding=json";Msn.Video.JavascriptApi.makeRequest(g,a,i)};Msn.Video.ConfigMgr=function(f,e,c){var a="default",b;function d(f,d,c){b=new Msn.Video.ResourceMgr(f,c);if(checkDefined(c))a=c;for(var e in d)b.setValue(null,e,d[e])}d(f,e,c);this.getValue=function(d,c,e){if(arguments.length==2){e=c;c=d;d=a}val=b.getValue(d,c,e);return val};this.setValue=function(c,d,e){if(arguments.length==2){e=d;d=c;c=a}if(c=="default")c=a;b.setValue(c,d,e)}};Msn.Video.CSS=function(){var a="undefined",b=null,d=["Moz","Webkit","O","Khtml"],c={};function e(j,f){var e=b;if(a==typeof c[f]){for(var g=0;g<d.length;g++){var i=d[g]+f;if(a!=typeof j.style[i]){e=i;break}e=b}if(b==e){var h=f.substr(0,1).toLowerCase(f)+f.substr(1);if(a!=typeof j.style[h])e=h}c[f]=e}else e=c[f];return e}return {setElementStyle:function(c,d,f){if(checkDefined(c)&&a!=typeof c.style){if(a==typeof c.style[d])d=e(c,d);if(b!=d)c.style[d]=f}},setStyle:function(a,d,c){if(checkArray(a))for(var b=0,e=a.length;b<e;++b)Msn.Video.CSS.setElementStyle(a[b],d,c);else Msn.Video.CSS.setElementStyle(a,d,c)},setCSS:function(c,a){for(var b in a)if(a.hasOwnProperty(b))Msn.Video.CSS.setStyle(c,b,a[b])},setOpacity:function(b,a){a=Math.max(0,Math.min(1,a));Msn.Video.CSS.setCSS(b,{filter:"alpha(opacity="+Math.round(a*100)+")",opacity:a})}}}();Msn.Video.Player=function(){var n="linkback",k="slplayerad",j="playerad",e="true",g="false",f="gmt",d="player",b=null,q=b,a,c,m,p,o,l,i;this.create=function(e,c){a=e;l=c;if(!checkDefined(a.cfgMgr)||!checkDefined(a.resMgr))Msn.Video.loadConfiguration(a,d,f,s);else s(b,a,b)};function z(){var h="slplayer",b;switch(c.getValue("leadwithplugin","").toLowerCase()){case "silverlight":b=true;break;case "flash":b=false;break;default:b=c.getValue(f,"leadWithSilverlight",g).toLowerCase()==e}if(b)switch(a.src.toLowerCase()){case d:a.src=h;break;case j:a.src=k}if(!Silverlight.isInstalled("4.0")&&c.getValue("downlevel","").toLowerCase()!="install")switch(a.src){case h:a.src=d;break;case k:a.src=j}}function s(D,E){var A="transparent",u="background",f="windowless",s="wmode",n="mode",t="adDivs",y="MsnVideoInitializeInternal",x="leadwithimage";c=E.cfgMgr||new Msn.Video.ConfigMgr(D.configs,a.flashvars,d);m=E.resMgr||new Msn.Video.ResourceMgr(D.resources);var B=c.getValue(x,g).toLowerCase();if(B&&(B==e||B=="yes")){c.setValue(x,g);a.cfgMgr=c;a.resMgr=m;var F=new Msn.Video.LeadWithImage;F.create(a,l)}else{p=a.widgetId;o=c.getValue("widgetGroup",b);if("undefined"!=typeof MsnVideo2&&b!=MsnVideo2)r();else{q=window[y];window[y]=r}z();var w=a.src.toLowerCase(),v=document.createElement("div");v.setAttribute("id",a.divId+"_content");l.appendChild(v);var i={};for(var C in a.flashvars)if(b!=a.flashvars[C])i[C]=a.flashvars[C].replace(/\&/g,"%26");if(w==j||w==k){v=Msn.Video.buildPlayerAdElements(v,a.divId);i[t]=(checkString(i[t])?i[t]+";":"")+a.divId+"_a|300|60"}if(w.substring(0,6)==d&&!checkString(i[n]))i[n]=checkString(i[n])?i[n]:"inline";a.params=a.params||{};var G=checkDefined(Msn.Video.Widgets[w].silverlight)?Msn.Video.Widgets[w].silverlight==true:false;a.src=Msn.Video.getWidgetEmbedAsset(a);h(s,a,c.getValue(s,undefined));h(f,a,c.getValue(f,undefined));h(u,a,c.getValue(u,undefined));if(undefined!=a.params[s])switch(a.params[s].toLowerCase()){case A:h(f,a,e);h(u,a,A);break;case "opaque":h(f,a,e);break;case "window":h(f,a,g)}if(G)Msn.Video.buildSLWidget(w,l,v,a,i);else return Msn.Video.buildFlashWidget(l,v,a,i)}}function h(b,a,c){if(!a.params[b])a.params[b]=c}function r(){MsnVideo2.addMessageReceiver({eventType:"playbackStatusChanged",widgetId:p,widgetGroup:o,funcCb:x});MsnVideo2.addMessageReceiver({eventType:"currentVideoChanged",widgetId:p,widgetGroup:o,funcCb:y});var a=MsnVideo2.getProperties({type:"currentVideo",widgetId:p,widgetGroup:o});if(b!=a&&a.length>0)t(a[0].param.video);if("function"==typeof q)q()}function y(a){var b=a.param.video;t(b)}function t(a){i=a;u()}function w(c){var b=document.getElementById(a.divId+"_t");if(b)b.innerHTML=c}function x(b){var a=b.param.status.toLowerCase();u("adplaying"==a||"adpaused"==a)}function u(q){var g="linkback last",o=checkObject(i);if(q)w(m.getValue(d,"ChannelsAdvertisement","Advertisement"));else w(o?i.title:"&nbsp");var h=document.getElementById(a.divId+"_m");if(h){var j,k;if(!q&&o&&checkArray(i.relatedLinks,1)&&i.sourceFriendly!=b){j=format(m.getValue(d,"ChannelsPartnerLink","Go to {0}"),i.sourceFriendly);k=i.relatedLinks[0].url}var l=checkString(k)&&checkString(j);h.innerHTML="";if(e==c.getValue(d,"msnlink",e)){var p=A();if(checkString(p)){var r=format(m.getValue(d,"ChannelsMoreText","View more {0} videos"),c.getValue(f,"brand","MSN"));h.appendChild(v(p,r,l?n:g))}}if(l)h.appendChild(v(k,j,g))}}function A(){var d="http://",a=c.getValue(n,b);if(!checkString(a)||a.indexOf(d)!=0){a=c.getValue(f,"MsnLinkBackDomainUri",b);if(checkString(a)){if(a.indexOf(d)!=0)a=d+a;var e={mkt:c.getValue("mkt","en-us"),brand:c.getValue("brand","MSN"),from:c.getValue("fr",b)||c.getValue("mkt",b)},h="",i="?";for(var g in e)if(checkString(e[g]))h+=format("{0}{1}={2}",i,g,e[g]);a+=h}}return a}function v(d,c,b){var a=document.createElement("A");a.href=d;a.innerHTML=c;a.className=b;return a}};Msn.Video.Gallery=function(){var b=null,h=this,a,d,g,f,c;this.create=function(g,d){a=g;c=d;f=a.widgetId;if(!checkDefined(a.cfgMgr)||!checkDefined(a.resMgr))Msn.Video.loadConfiguration(a,"gallery","gmt",e);else e(b,a,b)};function e(l,m){var e="wmode";d=m.cfgMgr||new Msn.Video.ConfigMgr(l.configs,a.flashvars,"gallery");g=m.resMgr||new Msn.Video.ResourceMgr(l.resources);var o=a.src.toLowerCase(),i=document.createElement("div");i.setAttribute("id",a.divId+"_content");c.appendChild(i);var j={};for(var k in a.flashvars)if(b!=a.flashvars[k])j[k]=a.flashvars[k].replace(/\&/g,"%26");a.params=a.params||{};a.src=Msn.Video.getWidgetEmbedAsset(a);if(d.getValue("playtype","inline")=="overlay"){var h=document.createElement("DIV");h.id=f+"OverlayPlayer";c.appendChild(h);var n=d.getValue("widgetGroup",b);Msn.Video.createWidget2({divId:h.id,src:"playeroverlay",w:300,h:300,flashvars:{widgetGroup:n},widgetId:h.id,weRoot:a.weRoot,cacheBuster:a.cacheBuster});j["gallery.playType"]="inline"}if(!a.params[e])a.params[e]=d.getValue(e,"transparent");return Msn.Video.buildFlashWidget(c,i,a,j)}};Msn.Video.ArticlePlayer=function(){var b="DIV",c="player",a=null,t=this,l=a,h,j,o,e,d,i,q,g,k,f;this.create=function(b,d){e=b;q=d;if(!checkDefined(b.cfgMgr)||!checkDefined(b.resMgr))Msn.Video.loadConfiguration(b,c,"gmt",n);else n(a,b,a)};function n(M,N){var n="true",u="false",A="MsnVideoInitializeInternal";d=N.cfgMgr||new Msn.Video.ConfigMgr(M.configs,e.flashvars,c);i=N.resMgr||new Msn.Video.ResourceMgr(M.resources);h=e.widgetId;j=h+"InternalGroup";if("undefined"!=typeof MsnVideo2&&a!=MsnVideo2)m();else{l=window[A];window[A]=m}var p=d.getValue("compactMode",u);p=a!=p&&p.toLowerCase()==n;var z=d.getValue("showMetadata",n);z=a==z||z.toLowerCase()!=u;var B=document.createElement(b);B.className="msnVideoArticlePlayer";var J=d.getValue("fontSizeOverride",a);if(checkString(J))try{B.style.fontSize=J}catch(x){}q.appendChild(B);g=document.createElement(b);g.className=p?"compact":"normal";var G=d.getValue("backgroundcolor1",a);if(a!=G)try{g.style.backgroundColor=G}catch(x){alert("backgroundcolor1 configured incorrectly")}B.appendChild(g);k=document.createElement(b);k.className="playerDiv";var I=h+"PlayerDiv";k.id=I;g.appendChild(k);if(z||p){var v=document.createElement(b);v.className="upperDiv";f=document.createElement(b);f.className="metadataDiv";var D=d.getValue("fontcolor1",a);if(a!=D)try{f.style.color=D}catch(x){alert("fontcolor1 configured incorrectly")}v.appendChild(f);g.appendChild(v)}if(!p){var H=d.getValue("showBottomArea",n),t=a;if(a==H||H.toLowerCase()!=u){t=document.createElement(b);t.className="bottomDiv";var F=d.getValue("backgroundcolor2",a);if(a!=F)try{t.style.backgroundColor=F}catch(x){alert("backgroundcolor2 configured incorrectly")}g.appendChild(t);var y=document.createElement(b);y.className="browseMoreDiv";var E=document.createElement("IMG"),R=Msn.Video.UrlHelper.getWERoot(e);E.src=R+"/i/articleplayer/arrow.png";E.className="arrow";y.appendChild(E);var w=document.createElement("A"),P="http://video.msn.com?mkt="+d.getValue("mkt","en-us");w.href=d.getValue("linkback",P);if(d.getValue("pl",n).toLowerCase()==n)w.target="_blank";w.appendChild(document.createTextNode(i.getValue(c,"MoreVideosText","Browse more videos")));var Q=d.getValue("fontColor3",a);if(a!=D)try{w.style.color=Q}catch(x){alert("fontColor3 configured incorrectly")}y.appendChild(w);t.appendChild(y)}}var C=document.createElement(b),K=h+"adDiv";C.id=K;C.className="adDiv";if(p){v.appendChild(C);var L=document.createElement(b);L.className="clear";v.appendChild(L)}else if(a!=t)t.appendChild(C);var r={};for(var O in e.flashvars)r[O]=e.flashvars[O];r["widgetId"]=o;r["adDivs"]=K+"|300|60";r["widgetGroup"]=j;r["rst"]="ArticlePlayer";r["fontsizeoverride"]=a;Msn.Video.createWidget2({divId:I,src:s(),w:e.w,h:e.h,flashvars:r,widgetId:o,root:e.root,weRoot:e.weRoot,vceRoot:e.vceRoot,cacheBuster:e.cacheBuster})}function s(){var a="slplayer";if(d.getValue("leadwithplugin","silverlight").toLowerCase()=="flash")a=c;return a}function p(e){var k=":</span> ",g="</span>",t=d.getValue("fontColor2",a),l="";if(a!=t)l=" style='color: "+t+"'";f.innerHTML="";var q=document.createElement(b);q.className="titleDiv";q.innerHTML=e.title;f.appendChild(q);var p=document.createElement(b);p.className="detailDiv";var r=new Date(e.startDate),x=r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear(),s="<div><span class='dateDetail'><span class='detailLabel'"+l+">"+i.getValue(c,"DateLbl","Date")+":</span>"+x+g,j=60*60,h=e.durationSecs,v=Math.floor(h/j);h%=j;j/=60;var u=Math.floor(h/j);h%=j;var y=Math.floor(h),n="";if(v>0)n+=padLeft(v,2,"0")+":";var w=u>0?2:1;n+=padLeft(u,w,"0")+":"+padLeft(y,2,"0");s+="<span class='durationDetail'><span class='detailLabel'"+l+">"+i.getValue(c,"DurationLbl","Duration")+k+n+g;var o;if(e.relatedLinks.length>0&&checkString(e.relatedLinks[0].url))o="<a class='videoByLink' href='"+e.relatedLinks[0].url+"' target='_blank'>"+e.sourceFriendly+"</a>";else o=e.sourceFriendly;s+="<span class='sourceDetail'><span class='detailLabel'"+l+">"+i.getValue(c,"VideoByLbl","Video By")+k+o+g;p.innerHTML=s;f.appendChild(p);var m=document.createElement(b);m.className="descriptionDiv";m.innerHTML=e.description;f.appendChild(m)}function r(a){var b=a.param.video;p(b)}function m(){MsnVideo2.addMessageReceiver({eventType:"currentVideoChanged",widgetId:h,widgetGroup:j,funcCb:r});var b=MsnVideo2.getProperties({type:"currentVideo",widgetId:h,widgetGroup:j});if(a!=b&&b.length>0)p(b[0].param.video);if("function"==typeof l)l()}};Msn.Video.OverlayPlayerLookup=window.Msn.Video.OverlayPlayerLookup||{};Msn.Video.OverlayPlayer=function(){var Pb="loadVideo",pb="widgetLoaded",Ob="rect(0px,0px,0px,0px)",lc="playlistCompleted",Nb="queueVideo",Mb="stopVideo",kc="playVideo",Lb="/image.aspx?w=128&h=72&so=4&uuid=",I="visible",g="block",eb="share",Kb="Check out this great {0} video",Jb="ShareTextMessageCommon",db="brand",Ib="fontsizeoverride",Hb="OverlayPlayer",Gb="widgetId",B="hidden",cb="resize",c=true,j="px",e="",f="none",p="true",bb="MsnVideoInitializeInternal",H="undefined",ab="widgetGroup",o="gmt",d="player",b=false,a=null,wd=this,jb=a,k,s,kb,ac,y,v,m,u,i,l,ib,Oc,kd=30,Vb=0,hd=5,gb=b,Gc,t,w,K,D,zb,A,r,G,nb,Cc,n,S,L,Zb,M,xb,z,N,Cb=b,rb,Fc=135,zd,qc=640,Rc=qc+15+Fc,vb=15+360+5+90+15,tc=vb+65,X,W=vb,pc=vb/2+65,Y=b,V,Jc=640,h,F=a,Yb=b,O,ob,U,x,sb=b,E,Ub,Ab,tb,T,Kc,Xb,fc,Wb=["ad","adpartial","adfull","timeplaying","videosplayed","timeelapsed","playadbeforefirstvid"],fb=[],Qb=0,ub,mb=b,ic=b,Ic=1e3,Ec=650,C,Rb,J,Eb,hc=b,bc=b,Tb=b,yd=b,lb=b,zc;this.create=function(b){u=b;if(!checkDefined(b.cfgMgr))Msn.Video.loadConfiguration(b,d,o,yc);else yc(a,b,a)};this.destroy=function(){R();ld();document.body.removeChild(t);t=a;Msn.Video.OverlayPlayerLookup[s]=a;delete Msn.Video.OverlayPlayerLookup[s]};function yc(Lb,Nb){var mb="leadWithPlugin",lb="headerImage",hb="arrow_right",gb="descriptionDiv",fb="titleDiv",eb="closeImg",db="0 0 10px black",I="BoxShadow",Z="adSkinDiv",b="DIV",F="false";i=Nb.cfgMgr||new Msn.Video.ConfigMgr(Lb.configs,u.flashvars,d);l=Nb.resMgr||new Msn.Video.ResourceMgr(Lb.resources);s=i.getValue(ab,a);var qb=checkString(s)?s:"*";if(Msn.Video.OverlayPlayerLookup.hasOwnProperty(qb))Msn.Video.OverlayPlayerLookup[qb].destroy();Msn.Video.OverlayPlayerLookup[qb]=wd;k=u.widgetId;y=k+"GalleryInternalGroup";m=k+"PlayerInternalGroup";v=k+"InternalPlayer";kb=k+"InternalGallery";ac=kb+"Div";ib=Msn.Video.UrlHelper.getWERoot(u);if(H==typeof MsnVideo2||a==MsnVideo2){jb=window[bb];window[bb]=rc;Msn.Video.JavascriptApi.fetchScript(ib+"/js/widgetframework.js","OverlayPlayerWidgetFramework")}wc();Vc();Oc=i.getValue("animateOpen",F)==p;t=document.createElement(b);t.style.display=f;t.className="msnVideoOverlayPlayer";var Y=l.getValue(d,"clickToClose","click to close");w=document.createElement(b);w.className="overlayDiv";w.onclick=R;if(!isChrome()&&!Msn.Video.isSafari())w.title=Y;t.appendChild(w);Msn.Video.CSS.setOpacity(w,.6);K=document.createElement(b);K.className="centerDiv";K.onclick=R;D=document.createElement(b);D.className="positionAdj";if(!isChrome()&&!Msn.Video.isSafari())D.title=Y;D.onclick=R;C=document.createElement(b);Rb=k+Z;C.id=Rb;C.className=Z;C.title=isFirefox()?" ":e;C.onclick=jc;D.appendChild(C);X=qc;z=document.createElement(b);z.className="contentWrapper";z.style.width=X+j;Msn.Video.CSS.setElementStyle(z,I,db);z.title=isFirefox()?" ":e;z.onclick=jc;var h=document.createElement(b);h.className=eb;h.onclick=R;h.title=Y;var Db=ib+"/i/overlayplayer/close_btn.png";if(checkDefined(h.style.filter)&&Msn.Video.isIE()){h.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src = '"+Db+"')";h.style.backgroundImage=f}else{var Ob=document.createElement("IMG");Ob.src=Db;h.appendChild(Ob)}xb=h;M=h.cloneNode(c);M.className=eb;M.onclick=R;M.title=Y;z.appendChild(xb);N=document.createElement(b);N.className="contentWrapperInner";var S=document.createElement(b);S.className="leftContainer";var pb=document.createElement(b);pb.className="playerDiv";pb.style.width=Jc+j;var Fb=k+"_playerDiv";pb.id=Fb;S.appendChild(pb);var q=document.createElement(b);q.className="bottomContainer";Msn.Video.CSS.setElementStyle(q,I,"0 0 6px black");var Jb=i.getValue("fontSizeOverride",a);if(checkString(Jb))try{q.style.fontSize=Jb}catch(Vb){}O=document.createElement(b);O.className="metadataWrapper";O.style.display=f;var ub=document.createElement("TABLE");ub.className="metadataTable";var Cb=document.createElement("TBODY"),yb=document.createElement("TR"),o=document.createElement("TD");o.style.width="100%";var Q=document.createElement(b);Q.className="metadataDiv";ob=document.createElement(b);ob.className=fb;Q.appendChild(ob);Lc(ob,cb,wb);U=document.createElement(b);U.className=gb;Q.appendChild(U);x=document.createElement(b);x.className="shareDiv";var vb=document.createElement(b);vb.className="shareText";vb.appendChild(document.createTextNode(l.getValue(d,"EndSlateShare","Share")));x.appendChild(vb);var Sb=Bb(a,"icon_mail","icon_mail_hover",l.getValue(d,"ChannelsShareEmail","E-mail this video to a friend"),Yc,"mailIcon");x.appendChild(Sb);var Pb=Bb(a,"icon_face","icon_face_hover",l.getValue(d,"FacebookShareText","Facebook"),Wc,"facebookIcon");x.appendChild(Pb);var Qb=Bb(a,"icon_twit","icon_twit_hover",l.getValue(d,"TwitterShareText","Twitter"),Xc,"twitterIcon");x.appendChild(Qb);var Tb=Bb(l.getValue(d,"MoreShareText","More"),hb,hb,l.getValue(d,"MoreShareToolTip","More sharing options"),Mc,"moreIcon");x.appendChild(Tb);Q.appendChild(x);o.appendChild(Q);yb.appendChild(o);o=document.createElement("TD");o.className="overlayAdCell";Eb=k+"adDiv";J=document.createElement(b);J.id=Eb;J.className="overlayAdDiv";o.appendChild(J);yb.appendChild(o);Cb.appendChild(yb);ub.appendChild(Cb);O.appendChild(ub);q.appendChild(O);E=document.createElement(b);E.className="upNextWrapper";E.style.display=f;var L=document.createElement(b);L.className="countdown";L.appendChild(document.createTextNode(l.getValue(d,"EndSlateUpNext","UP NEXT").toUpperCase()));L.appendChild(document.createElement("BR"));T=document.createElement(b);T.className="count";L.appendChild(T);E.appendChild(L);tb=document.createElement("IMG");tb.className="thumbImg";E.appendChild(tb);var W=document.createElement(b);W.className="upNextMeta";Ub=document.createElement(b);Ub.className=fb;W.appendChild(Ub);Ab=document.createElement(b);Ab.className=gb;W.appendChild(Ab);E.appendChild(W);q.appendChild(E);S.appendChild(q);N.appendChild(S);var sb=document.createElement(b);sb.className="rightContainer";rb=document.createElement(b);rb.id=ac;rb.className="galleryDiv";sb.appendChild(rb);N.appendChild(sb);z.appendChild(N);D.appendChild(z);zb=F!=i.getValue("header",F).toLowerCase();A=document.createElement(b);A.className=lb;A.style.visibility=B;Msn.Video.CSS.setElementStyle(A,I,db);A.title=isFirefox()?" ":e;var P=document.createElement(b);P.className="headerImageInner";P.onclick=jd;r=document.createElement("IMG");r.width=830;r.height=65;G=i.getValue(lb,a);r.onload=function(){dc(G)};if(checkString(G))r.src=G;nb=i.getValue("headerLinkback",a);P.appendChild(r);n=r.cloneNode(c);n.style.display=f;n.width=830;n.height=65;P.appendChild(n);A.appendChild(P);A.appendChild(M);D.appendChild(A);K.appendChild(D);t.appendChild(K);document.body.appendChild(t);var g=copyFlashVars(u.flashvars,d);setParam(g,Gb,v);setParam(g,ab,m);setParam(g,"rst",Hb);setParam(g,"adDivs",Rb+"|"+Ic+"|"+Ec+";"+Eb+"|300|60");setParam(g,Ib,a);setIfNotSet(g,"ap",p);setIfNotSet(g,"rvp",p);setIfNotSet(g,"slatetime","0");setIfNotSet(g,"hideplaylist",p);setIfNotSet(g,"initPanel",f);if(a==i.getValue(mb,a)&&a==i.getValue("player.leadWithPlugin",a))setIfNotSet(g,mb,"silverlight");Msn.Video.createWidget2({divId:Fb,src:d,w:Jc,h:360,flashvars:g,widgetId:v,weRoot:u.weRoot,cacheBuster:u.cacheBuster});V=a;var Mb=i.getValue("playonloaduuid",a);if(a!=Mb)V={uuid:Mb};else{var Kb=i.getValue("playonloadref",a);if(a!=Kb)V={shortId:Kb}}if(H!=typeof MsnVideo2&&a!=MsnVideo2)rc()}function Bb(h,o,m,n,j,c){var b="url(",d="shareButton ",a=document.createElement("A");a.className=d+(c?c:e);a.title=n;a.onclick=j;if(h)a.appendChild(document.createTextNode(h));var i="{0}/i/overlayplayer/{1}.png",g=format(i,ib,m),f=format(i,ib,o);if(Msn.Video.isIE(6)||Msn.Video.isIE(7)){a.className="shareButtonIE7 "+(c?c:e);a.style.backgroundImage=b+g+")"}else{a.className=d+(c?c:e);var k=new Image;k.src=f;var l=new Image;l.src=g;a.style.backgroundImage=b+f+")";a.onmouseover=function(){a.style.backgroundImage=b+g+")"};a.onmouseout=function(){a.style.backgroundImage=b+f+")"}}return a}function Yc(){var a=i.getValue(o,db,"MSN"),b=format("mailto:?subject={0}&body={1}%0D%0A%0A{2}%0D%0A{3}%0D%0A%0A{4}",encodeURIComponent(format(l.getValue(d,"ChannelsShareEmailSubject","Check out this video from {0}!"),a)),encodeURIComponent(format(l.getValue(d,"ChannelsShareEmailMessage","Check out this video from {0}:"),a)),encodeURIComponent(h.title),encodeURIComponent(uc()).replace(/%20/g,"%2520"),encodeURIComponent(format(l.getValue(d,"ChannelsShareEmailSignature"),i.getValue(o,"subbrand","The MSN Video Team"))));window.open(b)}function Wc(){var c=encodeURIComponent(sc("facebook")),b=encodeURIComponent(format(l.getValue(d,Jb,Kb),i.getValue(o,db,"MSN"))),a=format("http://www.facebook.com/sharer.php?u={0}&t={1}%3a+{2}",c,b,encodeURIComponent(h.title));openStandardWindow(a,"_overlayFacebook")}function Xc(){var b=encodeURIComponent(sc("twitter")),a=encodeURIComponent((format(l.getValue(d,Jb,Kb),i.getValue(o,db,"MSN"))+": "+h.title).substring(0,100));openStandardWindow(format("http://twitter.com/share?url={0}&text={1}",b,a),"_overlayTwitter")}function Mc(){var a=sb?"closePane":"openPane";q({type:a,targetId:v,targetGroup:m,param:{paneType:eb}})}function uc(){var e="video.msn.com",d=a;if(checkDefined(h)&&checkDefined(h.permalink)&&"string"==typeof h.permalink)d=h.permalink;else{var b=i.getValue("linkOverride2",a);if(!checkString(b)){b=i.getValue("linkOverride",a);if(checkString(b))b+="{0}"}if(checkString(b))d=format(b,h.uuid,h.shortId,i.getValue("mkt","en-us"))}if(!checkString(d)){var f={vid:"{0}",mkt:"{2}"},c=i.getValue(o,"MsnLinkBackDomainUri",e);if(!checkString(c))c=i.getValue("d",e);if(c.indexOf("http://")!=0&&c.indexOf("https://")!=0)c="http://"+c;b=Msn.Video.UrlHelper.addParamValuesToQuery(c,f);d=format(b,h.uuid,h.shortId,i.getValue("mkt","en-us"))}return d}function sc(a){var b=uc();if(checkString(a))a="-"+a;return Msn.Video.UrlHelper.addParamValueToQuery(b,"from","sharepermalink"+a)}var gc={};function Vc(){var d=i.getValue(o,"sourceHeaderImages",a);if(checkString(d)){var e=d.split(";");for(var c=0;c<e.length;++c){var b=e[c].split(":");if(checkArray(b,2))gc[b[0]]=b[1]}}}function dc(a){if(a==S)Zb=c;else if(a==G)Cc=c;P()}function rd(d){var c=document.images;for(var a=0;a<c.length;a++)if(c[a].src==d)return c[a];return b}function cd(c){var b=a;if(c&&checkString(c)){b=rd(c);if(!b||!checkString(b.src)){b=new Image;b.onloaded=function(){dc(c)};b.src=c}}return b}function Nc(k){if(zb){var d=b,j=c;if(k&&checkString(h.source)&&checkString(gc[h.source])){var i=format("{0}/i/header/{1}",ib,encodeURIComponent(gc[h.source]));if(i!=S){Zb=b;S=i;var l=cd(S);if(l){n.onload=function(){dc(S)};n.src=S}}if(Zb){L=checkArray(h.relatedLinks,1)?h.relatedLinks[0]:a;var m=L&&checkString(L.url);r.style.display=f;n.style.display=g;if(m){n.title=checkString(L.text)?L.text:e;n.style.cursor=Msn.Video.isIE(5)?"hand":"pointer"}else{n.title=e;n.style.cursor="default"}d=c;j=b}}if(j){n.style.display=f;if(Cc){r.style.display=g;if(checkString(nb))r.style.cursor=Msn.Video.isIE(5)?"hand":"pointer";else r.style.cursor="default";d=c}else oc()}if(d){M.style.display=g;xb.style.display=f;A.style.visibility=I;W=tc}}}function oc(){A.style.visibility=B;M.style.display=f;xb.style.display=g;W=vb}function P(){if(h&&Cb&&!Tb&&zb){if(h.isFailed||!h.isReady)Nc(b);else Nc(c);pc=W/2+(tc-W)}else oc()}function jd(b){if(!b)b=window.event;jc(b);var a;if(r.style.display==g)a=nb;else if(n.style.display==g&&checkDefined(L))a=L.url;if(checkString(a)){q({type:"pauseVideo",targetId:v,targetGroup:m});openStandardWindow(a,"_linkback")}}function yb(b,a){clearInterval(Kc);clearTimeout(Gc);if(gb){if(b){O.style.display=g;wb()}else O.style.display=f;if(a){E.style.display=g;Kc=setInterval(bd,500)}else E.style.display=f}}function bd(){var b=MsnVideo2.getProperties({type:"currentAdPosition",sourceId:k,sourceGroup:m});if(checkArray(b,1)){var a=b[0].param.duration-b[0].param.position;if(!isNaN(a))if(a>=1)Z(T,id(parseInt(a)));else{Z(T,e);lb=c;Dc()}}}function id(a){var b=parseInt(a/60);a=a%60;return format("{0}:{1}{2}",b||e,a>9?e:"0",a)}function fd(c){var f=i.getValue(c,e);if(checkString(f)){var b=f.split("|");for(var a=0;a<b.length;a++)if(a<fb.length)fb[a][c]=b[a];else{var d={};d[c]=b[a];fb.push(d)}}}function wc(){fb=[];for(var a=0;a<Wb.length;a++)fd(Wb[a])}function qd(f,e){var a=b,d=f[e];if(checkDefined(d)){i.setValue(e,d);a=c}return a}function pd(c){if(c&&checkDefined(c.param)&&checkDefined(c.param.configs)){var a=normalizeParamKeys(c.param.configs),f=b;for(var d=0;d<Wb.length;d++)f|=qd(a,Wb[d]);if(f)wc();zc=a["gallery.categoryrequests"]||a["categoryrequests"];var e=a["player.header"]||a["header"];if(checkString(e))zb=p==e;G=a["player.headerimage"]||a["headerimage"]||G;nb=a["player.headerlinkback"]||a["headerlinkback"]||nb;r.src=G;P()}}function Hc(){if(Qb<fb.length){q({type:"setAdvertisingOptions",targetId:v,targetGroup:m,param:fb[Qb]});Qb++}}function jc(a){if(!a)a=window.event;a.cancelBubble=c;if(a.stopPropagation)a.stopPropagation()}function Z(a,b){if(checkDefined(a.innerText))a.innerText=b;else a.textContent=b}function gd(a,b,d){if(d>0){var c=ud(a,b,d);a.innerHTML=c;a.title=c!=b?b:e}}function ud(e,d,h){var i=d,a=e.cloneNode(c);a.style.position="absolute";a.style.visibility=B;a.style.display=g;a.style.overflow=I;a.style.maxHeight=f;a.style.height="auto";a.innerHTML=d;e.parentNode.insertBefore(a,e.nextSibling);if(a.offsetHeight>h){var j="&hellip;",l=0,b=d.length;do{var k=(l+b)/2;a.innerHTML=d.substr(0,k)+j;if(a.offsetHeight>h)b=k-1;else l=k+1}while(l<b);i=a.innerHTML=d.substr(0,b)+j;while(a.offsetHeight>h&&b>0){--b;i=a.innerHTML=d.substr(0,b)+j}}e.parentNode.removeChild(a);return i}var mc;function wb(){if(mc){var a=Tc();U.style.height=a+j;gd(U,mc,a)}}function qb(b,a){mc=a;Z(ob,b);wb();Z(Ub,b);Z(Ab,a)}function Bc(b){h=b;if(b.isFailed){var e=l.getValue(d,"errorMetaData","cannot load metadata");qb(e,e);Gc=setTimeout(R,5e3)}else if(b.isReady){qb(b.title,b.description);tb.src=Msn.Video.UrlHelper.getVCImgRoot(u)+Lb+b.uuid;x.style.visibility=I;q({type:kc,targetId:v,targetGroup:m});F=a;Fb()}else{var c=l.getValue(d,"loadingMetaData","loading ...");qb(c,c)}P()}function vc(a){a.sourceGroup=s;a.targetGroup=s;q(a);a.sourceGroup=y;a.targetGroup=y;q(a);Bc(a.param.video)}function od(a){if(checkDefined(a)&&checkDefined(a.param)&&a.param.paneType==eb)sb=c}function nd(a){if(checkDefined(a)&&checkDefined(a.param)&&a.param.paneType==eb)sb=b}function Uc(g){var e="adplaying",d="videoplaying",a="videoopening",f=g.param.status.toLowerCase();if(!gb)switch(f){case a:case "videobuffering":case d:case "adopening":case e:q({type:Mb,targetId:v,targetGroup:m})}switch(f){case a:ic=b;break;case d:mb=c;lb=c;if(ub){Hc();ub=b}yb(c,b);break;case e:Tb=c;P();if(!mb)yb(b,c);if(ic)ad();break;case "adplaycompleted":case "adplayfailed":Ac();P();break;case "videoplaycompleted":case "videoplayfailed":ic=c;lb=c;Fb();break;case "playbackcompleted":case "playbackstopped":mb=b;ub=c}Db();Dc()}function md(a){if(a.param.id==Rb){hc=c;Db()}else if(a.param.id==Eb){bc=checkString(J.innerHTML);Db()}}function dd(){Fb()}function ad(){if(a!=F){qb(F.title,F.description);yb(b,c);tb.src=Msn.Video.UrlHelper.getVCImgRoot(u)+Lb+F.uuid}}function xc(){if(a!=F)q({type:Nb,targetId:v,targetGroup:m,param:{video:F}});else{Yb=c;Fb()}}var cc=b;function Fb(){if(a==F){cc=c;q({type:lc,sourceId:k,sourceGroup:y,targetId:kb,targetGroup:y})}}function Zc(a){if(a.type.toLowerCase()=="queuevideo"&&cc){cc=b;F=a.param.video;if(Yb){Yb=b;xc()}}else{a.targetGroup=m;q(a)}}function Ac(){Tb=b;hc=b;C.innerHTML=e}function Db(){if(checkDefined(C)){var b=hc&&Tb;C.style.display=b?g:f}if(checkDefined(J)){var a=bc&&mb;J.style.display=a?g:f}}function Lc(a,c){if(a.attachEvent)a.attachEvent("on"+c,hb);else a.addEventListener(c,hb,b)}function vd(d){K.style.clip=Ob;qb(e,e);Z(T,e);J.innerHTML=e;bc=b;Ac();Db();var a=td();t.style.top=a.scrollY+j;w.style.top=-a.scrollY+j;w.style.left=-a.scrollX+j;N.style.visibility=B;w.style.display=g;t.style.display=g;Lc(window,cb,hb);gb=c;hb();Vb=0;Qc(d)}function Tc(){return Math.max(0,Pc(x).y-Pc(U).y)}function hb(){var c=f!=C.style.display,a=document.body,b=document.documentElement;w.style.width=Math.max(c?Ic:X,a.clientWidth,b.clientWidth,a.scrollWidth,b.scrollWidth,a.offsetWidth,b.offsetWidth)+j;w.style.height=Math.max(c?Ec:W,a.clientHeight,b.clientHeight,a.scrollHeight,b.scrollHeight,a.offsetHeight,b.offsetHeight)+j;wb()}function Qc(a){if(Oc&&Vb<=110){Vb+=hd;var c=Vb/100,d=X/2*c,e=W/2*c,f="rect("+Math.round(pc-e)+"px,"+Math.round(d)+"px,"+Math.round(pc+e)+"px,"+Math.round(-d)+"px)";K.style.clip=f;setTimeout(function(){Qc(a)},kd)}else{K.style.clip="rect(0px,500px,650px,-500px)";N.style.visibility=I;q({type:"overlayOpened",sourceGroup:s,targetGroup:s});fc=b;if(a)a()}}function td(){var a=document.body,c=a.scrollTop,b=a.scrollLeft;if(0==c)if(window.pageYOffset)c=window.pageYOffset;else c=a.parentElement?a.parentElement.scrollTop:0;if(0==b)if(window.pageXOffset)b=window.pageXOffset;else b=a.parentElement?a.parentElement.scrollLeft:0;return {scrollY:c,scrollX:b}}function Pc(a){var b=0,c=0;while(a){b+=a.offsetLeft;c+=a.offsetTop;a=a.offsetParent}return {x:b,y:c}}function R(){var a=gb;gb=b;D.style.clip=Ob;x.style.visibility=B;oc();if(!isChrome()||Y)t.style.display=f;else fc=c;if(isFirefox()||isChrome())Y=b;Xb={type:Mb,targetId:v,targetGroup:m};if(Y)q(Xb);yb(b,b);mb=b;lb=b;if(sb){Mc();sb=b}if(window.detachEvent)window.detachEvent("onresize",hb);else window.removeEventListener(cb,hb,b);if(a&&H!=typeof MsnVideo2)q({type:"overlayClosed",sourceGroup:s,targetGroup:s})}function ec(a){Qb=0;Hc();ub=c;a.targetId=v;a.targetGroup=m;q(a)}function nc(c){h=a;Cb=b;rb.innerHTML=e;var d=a;if(!Y)Xb=c;else if(gb)ec(c);else d=function(){ec(c)};vd(d)}function ed(){Y=c;ec(Xb);if(isChrome()&&fc){t.style.display=f;Y=b}}function sd(b){var c="us";for(var d in b.tags){var a=b.tags[d];if(checkDefined(a)&&checkString(a.mk))c=a.mk}return c}function Dc(){if(!Cb&&a!=h&&lb){X=Rc;z.style.width=X+j;var d=zc||encodeURI("relatedVideos.aspx?uuids="+h.uuid+"&mk="+sd(h)+"&alg=0&ff=81&ind=3&ps=12&rct=1,2,3,4,5,6"),b=copyFlashVars(u.flashvars,"gallery");setParam(b,"configcsid","MSNvideo");setParam(b,"configname","divoverlaygallery");setParam(b,Gb,kb);setParam(b,ab,y);setParam(b,"rst",Hb);setParam(b,"smartPoolCtx","oGal");setParam(b,"playtype","inline");setParam(b,Ib,a);setIfNotSet(b,"categoryRequests",d);setIfNotSet(b,"cp",p);setIfNotSet(b,"rvp",p);Msn.Video.createWidget2({divId:ac,src:"gallery",w:Fc,h:455,flashvars:b,widgetId:kb,weRoot:u.weRoot,cacheBuster:u.cacheBuster});Cb=c;P()}}var Q=[{eventType:pb,handler:ed},{eventType:Pb,handler:nc,external:c},{eventType:Nb,handler:nc,external:c},{eventType:"setConfigs",handler:pd,external:c},{eventType:"currentVideoChanged",handler:vc},{eventType:"currentVideoDataUpdated",handler:vc},{eventType:"playbackStatusChanged",handler:Uc},{eventType:"companionAdRendered",handler:md},{eventType:"paneOpened",handler:od},{eventType:"paneClosed",handler:nd},{eventType:lc,handler:xc}],Sb=[Nb,Pb,kc];function rc(){for(var b=0;b<Q.length;++b){var e=Q[b].external&&Q[b].external;MsnVideo2.addMessageReceiver({eventType:Q[b].eventType,widgetId:k,widgetGroup:e?s:m,funcCb:Q[b].handler})}for(var c=0;c<Sb.length;c++)MsnVideo2.addMessageReceiver({eventType:Sb[c],widgetId:k,widgetGroup:y,funcCb:Zc});MsnVideo2.addMessageReceiver({eventType:pb,widgetId:k,widgetGroup:y,funcCb:dd});var d=MsnVideo2.getProperties({type:"currentVideo",sourceId:k,sourceGroup:m});if(checkArray(d,1))Bc(d[0].param.video);if("function"==typeof jb){jb();jb=a}setTimeout(Sc,0)}function Sc(){if(checkObject(V)){var b=V;V=a;b.playSource="OverlayPlayer:spawn::"+(b.uuid?"uuid":b.shortId?"shortId":a);nc({type:Pb,param:b})}}function ld(){if(H!=typeof MsnVideo2&&a!=MsnVideo2){for(var b=0;b<Q.length;++b)MsnVideo2.removeMessageReceiver({eventType:Q[b].eventType,widgetId:k,widgetGroup:m});for(var c=0;c<Sb.length;c++)MsnVideo2.removeMessageReceiver({eventType:Sb[c],widgetId:k,widgetGroup:y});MsnVideo2.removeMessageReceiver({eventType:pb,widgetId:k,widgetGroup:y})}else window[bb]=jb||a}function q(a){MsnVideo2&&MsnVideo2.sendMessage(a)}};Msn.Video.OverlayProxy=function(){var b="undefined",a,e;function d(d,a){if(b!=typeof window.MsnVideoUx&&checkFunction(window.MsnVideoUx.launchOverlayPlayer))c(d,a);else Msn.Video.JavascriptApi.loadJS("http://"+Msn.Video.V5AssetHost+(checkFunction(window.jQuery)?"/s/js/vxp_min.js":"/s/js/vxp.js"),function(){c(d,a)})}function c(h,a){var e="player.reportingtype",d="player.fr";if(b!=typeof window.MsnVideoUx&&checkFunction(window.MsnVideoUx.launchOverlayPlayer)){var c={},f=a.name||"default",g=a.csid||"ux-en-us";if(checkInt(a.initialmoduleindex))if(a.initialmoduleindex>0)c.InitialModuleIndex=a.initialmoduleindex;else if(a.playonloaduuid||a.playonloadref){f="vxp_launch_empty";c.DynamicInitialVideoId=a.playonloaduuid||a.playonloadref;c.DynamicModules="video"}if(checkString(a[d]))c.DynamicReportingFr=a[d];if(checkString(a[e]))c.DynamicReportingType=a[e];MsnVideoUx.launchOverlayPlayer(f,g,c,{hubDomain:a.hubdomain})}else openStandardWindow(h,"_top")}return {create:function(c){e=c;var n=new String(c.url),i=n.split("?");if(2>i.length)throw new Error("Invalid param.url, malformed query string: "+c.url+"\nMake sure you encode urls in the query string.");var b=Msn.Video.JavascriptApi.getQSPs(i[1]);b.overlaytype=b.overlaytype||"overlayplayer";var m="vid videoid cp-documentid uuid v g".split(" ");for(var l=0;l<m.length;++l){var j=m[l];if(checkString(b[j])){b.playonloaduuid=b[j];delete b[j];break}}if(!checkDefined(b.playonloaduuid)){var g=i[0].split("/");if(checkArray(g,2)){var k=g.length,o=checkString(g[k-1])?g[k-1]:g[k-2];b.playonloadref=o}}if("multimediaviewer"==b.overlaytype)d(n,b);else{if(!a)a="OverlayHolder"+Math.random();var f=document.getElementById(a);if(!checkDefined(f)){f=document.createElement("DIV");f.id=a;document.body.appendChild(f)}f.innerHTML="";b.widgetGroup=b.widgetGroup;var h={divId:a,src:"playeroverlay",widgetId:b.widgetId,flashvars:b,cachebuster:c.cachebuster||false};if(c.root)h.root=c.root;if(c.weRoot)h.weRoot=c.weRoot;Msn.Video.createWidget2(h)}return false}}}();Msn.Video.LeadWithImagePlayers=[];Msn.Video.LeadWithImage=function(){var c="block",j="player",a="none",b=null,C=this,i=1024,e,g,w,u=b,p,o,v,r,q,k,n,t,z,f,d,m,l,h,s;this.create=function(a,d){e=a;z=d;g=a.cfgMgr;w=a.resMgr;o=e.widgetId;v=g.getValue("widgetGroup",b);m=g.getValue("leadWithImageUrl",b);if(checkString(m)){m=unescape(m);l=g.getValue("leadWithImageTitle","");x()}else{var c=F();if(c)I(c.uuid);else x()}};function I(d){var c=Msn.Video.UrlHelper.getVCERoot(e),a=c+"/videoByUuid.aspx?uuid="+d+"&responseEncoding=json";Msn.Video.JavascriptApi.makeRequest(a,b,x)}function x(T){var N="playBtnDiv",A="px",x="IMG",M="progid:DXImageTransform.Microsoft.AlphaImageLoader(src = '",L="MsnVideoInitializeInternal",i="DIV";r=getCreateWidgetParamValue(e,"w",640);q=getCreateWidgetParamValue(e,"h",360);k=g.getValue("leadWithImageWidth",r);n=g.getValue("leadWithImageHeight",q);t=r!=k||q!=n;if(T){m=E(T.uuid.$,k,n);l=T.title.$}if(!checkString(l)||!checkDefined(l))l="";var I=document.createElement(i);I.className="msnLeadWithImage";z.appendChild(I);if("undefined"!=typeof MsnVideo2)y();else{p=false;u=window[L];window[L]=y}var P=Msn.Video.UrlHelper.getWERoot(e);if(t){var R=document.createElement(i);R.className="headerDiv";I.appendChild(R);f=document.createElement(i);f.className="closeBtnDiv";f.style.display=a;f.title=w.getValue(j,"clickToClose","click to close");f.onclick=C.hidePlayer;R.appendChild(f);var B=document.createElement(i);f.appendChild(B);var D=document.createElement(i);D.style.display=a;f.appendChild(D);f.onmouseover=function(){B.style.display=a;D.style.display=c};f.onmouseout=function(){D.style.display=a;B.style.display=c};var X=P+"/i/leadWithImage/close_btn.png",U=P+"/i/leadWithImage/close_btn_hover.png";if(Msn.Video.isIE()&&IEVersion<7&&checkDefined(B.style.filter)){B.style.filter=M+X+"')";B.style.backgroundImage=a;D.style.filter=M+U+"')";D.style.backgroundImage=a}else{var Z=document.createElement(x);Z.src=X;B.appendChild(Z);var W=document.createElement(x);W.src=U;D.appendChild(W)}}d=document.createElement(i);d.className="imageDiv";d.style.width=k+A;d.style.height=n+A;var ab=g.getValue("fontSizeOverride",b);if(checkString(ab))try{d.style.fontSize=ab}catch(fb){}d.title=l;d.onclick=G;I.appendChild(d);var Q=document.createElement(i);Q.className="thumbnailDiv";d.appendChild(Q);if(checkString(m)){var H=document.createElement(x);H.className="thumbnail";H.src=m;H.width=k;H.height=n;Q.appendChild(H)}var db=document.createElement(i);db.className="clear";d.appendChild(db);var F=n*.4,s=document.createElement(i);s.className=N;s.style.left=(k-F)/2+A;s.style.width=s.style.height=F+A;d.appendChild(s);var v=s.cloneNode(true);v.className=N;v.style.display=a;v.style.width=v.style.height=F+A;d.appendChild(v);d.onmouseover=function(){s.style.display=a;v.style.display=c};d.onmouseout=function(){v.style.display=a;s.style.display=c};var bb="/i/leadWithImage/"+(F>70?"135x135":"70x70")+"_play_overlay",Y=P+bb+".png",V=P+bb+"_hover.png";if(checkDefined(s.style.filter)&&Msn.Video.isIE()){var eb="progid:DXImageTransform.Microsoft.AlphaImageLoader(src = {0}, sizingMethod='scale')";s.style.filter=format(eb,Y);s.style.backgroundImage=a;v.style.filter=format(eb,V);v.style.backgroundImage=a}else{var O=document.createElement(x);O.src=Y;O.width=O.height=F;s.appendChild(O);var J=document.createElement(x);J.src=V;J.width=J.height=F;v.appendChild(J)}var cb=k>600?"Wide":k<=300?"Narrow":"",K=document.createElement(i);K.className="titleBackground"+cb;K.innerHTML=l;Msn.Video.CSS.setOpacity(K,.7);d.appendChild(K);var S=document.createElement(i);S.className="title"+cb;S.innerHTML=l;d.appendChild(S);h=document.createElement(i);h.className="playerDiv";h.id=o+"PlayerDiv";h.style.display=a;h.innerHTML=j;I.appendChild(h);Msn.Video.LeadWithImagePlayers.push(C)}function G(){var k="leadWithPlugin";if(h.innerHTML==j){h.innerHTML="";var i=copyFlashVars(e.flashvars,j);setParam(i,"rst","LeadWithImagePlayer");setParam(i,"fontsizeoverride",b);setIfNotSet(i,"ap","true");if(b==g.getValue(k,b)&&b==g.getValue("player.leadWithPlugin",b))setIfNotSet(i,k,"silverlight");Msn.Video.createWidget2({divId:h.id,src:e.src,w:r,h:q,flashvars:i,widgetId:o,root:e.root,weRoot:e.weRoot,vceRoot:e.vceRoot,cacheBuster:e.cacheBuster,cfgMgr:g,refMgr:w})}var l=Msn.Video.LeadWithImagePlayers.length;while(l-->0)Msn.Video.LeadWithImagePlayers[l].hidePlayer();d.style.display=a;h.style.display=c;if(t)f.style.display=c;s=true;if(p)MsnVideo2.sendMessage({type:"playVideo",targetId:e.widgetId})}this.hidePlayer=function(){if(s){B();d.style.display=c;h.style.display=a;if(t)f.style.display=a;s=false}};function B(){if(p)MsnVideo2.sendMessage({type:"pauseVideo",targetId:o,targetGroup:v})}VCQueryType={Uuid:1,Csid:2,Market:3,Tag:4,Search:5,Related:6,Random:7};function H(a){var b=a,c=""}function F(){var a=b,f=g.getValue("c","v");switch(f){case "v":a=new H(VCQueryType.Uuid);var e=g.getValue("v","").split(",");for(var d=0;d<e.length;++d){var c=e[d];if(c&&c.length>0){a.uuid=c;break}}}return a}function E(h,b,a){var j="";if(b>0&&a>0&&checkString(h)){if(b>i){a*=i/b;b=i}if(a>i){b*=i/a;a=i}var c=[{xr:2,yr:3},{xr:1,yr:1},{xr:4,yr:3},{xr:16,yr:9}],d=A(b,a,c[0].xr,c[0].yr);for(var f=1;f<c.length;++f){var g=A(b,a,c[f].xr,c[f].yr);if(d.maxDiff>g.maxDiff)d=g}j=format("{0}/image.aspx?uuid={1}&w={2}&h={3}&so=4",Msn.Video.UrlHelper.getVCImgRoot(e),h,d.x,d.y)}return j}function A(f,e,c,d){var b=Math.floor(Math.min(Math.min(f,i)/c,Math.min(e,i)/d)),a={};a.scale=b;a.x=b*c;a.y=b*d;a.maxDiff=Math.max(Math.abs(f-a.x),Math.abs(e-a.y));return a}function D(b){var a=b.param.status.toLowerCase();switch(a){case "videoopening":case "videobuffering":case "videoplaying":case "adopening":case "adplaying":if(!s)B()}}function y(){MsnVideo2.addMessageReceiver({eventType:"playbackStatusChanged",widgetId:o,widgetGroup:v,funcCb:D});p=true;if("function"==typeof u)u()}};Msn.Video.V5Container=function(){return {create:function(a,b){_param=a;_container=b;_initInternalCb=a.cbFun}}}();Msn.Video.LoadCSS=function LoadCSS(){Msn.Video.initializeVersionTable();if(Msn.Video.VersionTable.hasVersions)Msn.Video.CountryCodeLoader.loadCountryCode(a);else a();function a(){var b=Msn.Video.CountryCodeLoader.getVersionPath(),a="img1.widgets.video.msn.com";if(Msn.Video.WidgetServer&&checkString(Msn.Video.WidgetServer))a=Msn.Video.WidgetServer;Msn.Video.JavascriptApi.loadCSS(format("http://{0}/{1}{2}",a,b,"js/ch/channels.css"))}}();Msn.Video._loaded=(new Date).getTime()