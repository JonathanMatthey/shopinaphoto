/*
		$Id: lib.js 63886 2010-12-16 19:50:04Z msmith $
	$URL: http://10.134.130.120/svn/CodeDB/branches/stable/webroot/images/js/m4/lib.js $
*/


var tm;if(!tm){tm={}}else if(typeof tm!="object"){throw new Error("tm already exists but is not an object");}
$.root=$(document);jQuery.fn.adviceChannel=function(){if($("body").hasClass("tra")&&$(this).find("li.adv a.current")){$(this).find("li.adv a").css("background-position","-9999em -9999em").children("span").css("background-position","-9999em -9999em");$(this).find("li.tra a").css("background-position","0 -480px").children("span").css("background-position","100% -520px");$(this).find("li.adv").mouseover(function(){$(this).find("a").css("background-position","0 -480px").children("span").css("background-position","100% -520px");});$(this).find("li.adv").mouseout(function(){$(this).find("a").css("background-position","-9999em -9999em").children("span").css("background-position","-9999em -9999em");});}};jQuery.fn.dropdownNav=function(){if($.browser.msie&&$.browser.version.substr(0,3)=="6.0"){$(this).children("li").mouseover(function(){var arrayOfClasses=$(this).attr("class").split(' ');$(this).addClass(arrayOfClasses[0]+"over");}).mouseout(function(){var arrayOfClasses=$(this).attr("class").split(' ');$(this).removeClass(arrayOfClasses[1]);});}};$.fn.infiniteCarousel=function(){return this.each(function(){var $wrapper=$(this).css('overflow','hidden'),$slider=$wrapper.find('> div'),$items=$slider.find('> ul'),$single=$items.filter(':first'),singleWidth=$single.outerWidth(),visible=Math.ceil($wrapper.innerWidth()/singleWidth),currentPage=1,pages=Math.ceil($items.length/visible);$items.filter(':first').before($items.slice(-visible).clone().addClass('cloned'));$items.filter(':last').after($items.slice(0,visible).clone().addClass('cloned'));$items=$slider.find('> ul');$wrapper.scrollLeft(singleWidth*visible);function gotoPage(page){var dir=page<currentPage?-1:1,n=Math.abs(currentPage-page),left=singleWidth*dir*visible*n;$wrapper.filter(':not(:animated)').animate({scrollLeft:'+='+left},500,function(){if(page==0){$wrapper.scrollLeft(singleWidth*visible*pages);page=pages;}else if(page>pages){$wrapper.scrollLeft(singleWidth*visible);page=1;}
currentPage=page;});return false;}
$wrapper.after('<div class="controls"><a class="arrow back">Previous page</a><a class="arrow forward">Next page</a></div>');$("a.back").click(function(){return gotoPage(currentPage-1);});$("a.forward").click(function(){return gotoPage(currentPage+1);});$(this).bind('goto',function(event,page){gotoPage(page);});});};function inSkinFix(){$(".ad0").addClass("InSkinHide");$(".bongs").addClass("InSkinHide");}
jQuery.fn.storyListSlider=function(config){var ss=this,button=ss.find(".btn_lnk"),panel=ss.find(".panel"),panelWrapper=panel.parent();button.hover(function(){var index=button.index(this);panel.hide();panel.eq(index).show();button.removeClass("active").filter(":eq("+index+")").addClass("active");return false;}).filter(":first").hover();button.click(function(){return true;});};function upgradeIE6(){var HTMLStr='<div class="uie6">'
+'<h3>Your browser is no longer supported.<br />Please upgrade to a modern browser.</h3>'
+'<a target="_blank" href="http://www.google.com/chrome"><img src="http://images.mirror.co.uk/collections/m4_general/chrome.jpg" alt="Download Chrome" /></a>'
+'<a target="_blank" href="http://www.mozilla-europe.org/en/firefox/"><img src="http://images.mirror.co.uk/collections/m4_general/firefox.jpg" alt="Download Firefox" /></a>'
+'<a target="_blank" href="http://www.apple.com/safari/"><img src="http://images.mirror.co.uk/collections/m4_general/safari.jpg" alt="Download Safari" /></a>'
+'<a target="_blank" href="http://www.microsoft.com/windows/internet-explorer/default.aspx"><img src="http://images.mirror.co.uk/collections/m4_general/internet_explorer.jpg" alt="Download Internet Explorer" /></a>'
+'<a class="close" href="javascript:void(0);"></a>'
+'</div>';$.root.find("#wrap").prepend(HTMLStr);$.root=$(document);var uIE6=$.root.find(".uie6"),closeBtn=uIE6.find(".close");closeBtn.click(function(){uIE6.hide();});}
$.urlParam=function(name){var name=name,results=new RegExp('[\\?&]'+name+'=([^&#]*)').exec(window.location.href);if(results!=null){return results[1];}};tm.scratchcards={};tm.scratchcards.init=function(){var urlAr=$.urlParam("AR"),urlCorId=$.urlParam("CorID"),urlSentDate=$.urlParam("SentDate"),isValidSentDate=false;if(urlAr==null){urlAr='';}
if(urlCorId!=null&&urlCorId!=""&&urlSentDate!=null&&urlSentDate!=""){var aSentDate=urlSentDate.split("-");if(aSentDate.length==3){try{var sentDate=new Date(aSentDate[0],aSentDate[1]-1,aSentDate[2]);isValidSentDate=true;}
catch(e){}}
if(isValidSentDate){var today=new Date(),emailExpiryDate=new Date(),corExpDate=new Date();emailExpiryDate.setDate(emailExpiryDate.getDate()-30);if(sentDate>emailExpiryDate){corExpDate.setHours(corExpDate.getHours()+12);var corExpDateStr=corExpDate.format('yyyy\-mm\-d H\:MM\:s'),cValue="CorID="+urlCorId+"&amp;SentDate="+urlSentDate+"&amp;CorExpDate="+corExpDateStr,cExpiry=12*60*60;tm.setCookieVal("SCRATCHCARD_HOME",cValue,cExpiry,'/');}}}};$(document).ready(function(){$("ul.menu").dropdownNav();$("ul.menu").adviceChannel();if($(".infiniteCarousel").length>0){$('.infiniteCarousel').infiniteCarousel();}
if($("#storylist-slider").length>0){$("#storylist-slider").storyListSlider();}
if($.browser.msie&&$.browser.version<="6.0"){upgradeIE6();}
inSkinFix();});